# P2P File Transfer ğŸš€

A peer-to-peer file transfer application built in Rust using TCP protocol for direct file sharing between devices. Turn any device into a file server and share files instantly over your local network!

## ğŸ“‹ Overview

This is a lightweight, decentralized file transfer system that lets you share files directly between devices without any central server. Simply make one device act as the server (host) and connect from other devices as clients to transfer files.

**Perfect for:**

- ğŸ“± Transferring files between your phone and laptop
- ğŸ’» Sharing files across computers on the same network
- ğŸ  Quick file sharing at home without cloud services
- ğŸ”’ Private, offline file transfers

### ğŸ¯ How It Works

Think of it like **turning your device into a file sharing hub**:

1. **Server Mode** - Your device becomes a file host ğŸ“®

   - Opens a specific port and waits for connections
   - Shares files from a designated folder
   - Can handle multiple clients simultaneously

2. **Client Mode** - Connect to any server device ğŸ‘¤
   - Connects to the server's IP address and port
   - Downloads files to a local folder
   - Direct peer-to-peer connection

**Key Concept:** No third-party servers needed! You control both ends of the connection.

## ğŸ—ï¸ Project Structure

```
file-transfer/
â”œâ”€â”€ Cargo.toml                    # Rust dependencies (clap for CLI)
â”œâ”€â”€ README.MD                     # This file
â”œâ”€â”€ learnings.txt                 # Development notes
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main.rs                   # Entry point - CLI parsing
â”‚   â”œâ”€â”€ client/
â”‚   â”‚   â”œâ”€â”€ mod.rs               # Client module exports
â”‚   â”‚   â””â”€â”€ client.rs            # Client: connects and downloads
â”‚   â”œâ”€â”€ server/
â”‚   â”‚   â”œâ”€â”€ mod.rs               # Server module exports
â”‚   â”‚   â””â”€â”€ server.rs            # Server: hosts and serves files
â”‚   â””â”€â”€ shared/
â”‚       â”œâ”€â”€ mod.rs               # Shared utilities
â”‚       â”œâ”€â”€ upload.rs            # File upload logic
â”‚       â”œâ”€â”€ download.rs          # File download logic
â”‚       â””â”€â”€ helper.rs            # Helper functions
â”œâ”€â”€ test/                        # Server-side test files
â””â”€â”€ test2-client/                # Client-side download folder
```

## ğŸ› ï¸ Technical Overview

### Core Technologies

- **Language**: Rust ğŸ¦€ - Memory-safe systems programming
- **Protocol**: TCP - Reliable, connection-oriented data transfer
- **Architecture**: Peer-to-peer (P2P) client-server model
- **CLI Framework**: Clap v4.5 - Elegant command-line parsing

### Key Concepts Learned & Implemented

Based on development learnings:

1. **TCP Byte Streaming** ğŸ“¡

   - Data transmission in raw bytes over TCP
   - Understanding send/receive operations at the socket level

2. **Chunk-based Transfer** ğŸ“¦

   - Files sent/received in chunks (buffers)
   - Efficient memory usage for large files
   - Progress tracking capability

3. **Serialization & Deserialization** ğŸ”„

   - Converting data structures to bytes for network transmission
   - Reconstructing data on the receiving end

4. **File System Management** ğŸ“

   - Rust's file I/O operations (`std::fs`)
   - Path handling and directory operations
   - Creating/reading files programmatically

5. **Multithreading** ğŸ§µ

   - Running multiple functions concurrently
   - Thread-per-connection model
   - Independent handling of multiple clients

6. **Async Programming** âš¡
   - Asynchronous operations for I/O
   - Non-blocking file operations
   - Improved performance and responsiveness

## ğŸš€ Quick Start Guide

### Step 1: Set Up the Server (File Host Device)

On the device that will share files, run:

```bash
cargo run -- -s -p 8080 --address 127.0.0.1 -l ./test/2025-11-02\ 10-30-16.mp4
```

**What this does:**

- `-s` - Starts in **server mode** (makes your device the host)
- `-p 8080` - Opens port **8080** for connections
- `--address 127.0.0.1` - Binds to **localhost** (use your local IP for network sharing)
- `-l ./test/2025-11-02\ 10-30-16.mp4` - Path to the **file to share**

> **Network Sharing Tip:** Replace `127.0.0.1` with your device's local IP (e.g., `192.168.1.100`) to share across your network. Find your IP with `ip addr` (Linux) or `ipconfig` (Windows).

### Step 2: Connect as Client (Receiving Device)

On the device that will receive the file, run:

```bash
cargo run -- -p 8080 --address 127.0.0.1 -l ./test2-client/file.mp4
```

**What this does:**

- `-p 8080` - Connects to port **8080** (must match server port)
- `--address 127.0.0.1` - Server's IP address (use actual IP for network transfer)
- `-l ./test2-client/file.mp4` - Where to **save the downloaded file**

> **Note:** The client does NOT use `-s` flag - that's only for server mode!

### Example: Real Network Transfer

**On Server Device (192.168.1.100):**

```bash
cargo run -- -s -p 8080 --address 192.168.1.100 -l ./videos/movie.mp4
```

**On Client Device:**

```bash
cargo run -- -p 8080 --address 192.168.1.100 -l ./downloads/movie.mp4
```

## ğŸ“‹ Command Reference

### Server Command Structure

```bash
cargo run -- -s -p <PORT> --address <IP_ADDRESS> -l <FILE_PATH>
```

### Client Command Structure

```bash
cargo run -- -p <PORT> --address <SERVER_IP> -l <SAVE_PATH>
```

### Parameters Explained

| Parameter    | Short | Required    | Description                                     | Example                   |
| ------------ | ----- | ----------- | ----------------------------------------------- | ------------------------- |
| `--host`     | `-s`  | Server only | Run in server mode                              | `-s`                      |
| `--port`     | `-p`  | Yes         | Port number (1024-65535)                        | `-p 8080`                 |
| `--address`  | N/A   | Yes         | IP address (server bind/client connect)         | `--address 192.168.1.100` |
| `--location` | `-l`  | Yes         | File path (server: source, client: destination) | `-l ./folder/file.mp4`    |
| `--code`     | `-c`  | No          | Connection code (future feature)                | `-c ABC123`               |

### Tips for Using Commands

- **Escape spaces in file paths** with backslash: `./test/my\ file.mp4`
- **Use quotes** for paths with spaces: `"./test/my file.mp4"`
- **Port numbers**: Choose any unused port (8080, 9000, 3000 are common choices)
- **Firewall**: Make sure the port is open if connecting across devices

## âš¡ How It Works Under The Hood

### Connection Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   CLIENT    â”‚                           â”‚   SERVER    â”‚
â”‚  (Downloader)â”‚                          â”‚ (File Host) â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                           â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚                                         â”‚
       â”‚  1. TCP Connection Request              â”‚
       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
       â”‚                                         â”‚
       â”‚  2. Connection Accepted                 â”‚
       â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
       â”‚                                         â”‚
       â”‚  3. Request File                        â”‚
       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
       â”‚                                         â”‚
       â”‚                                    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
       â”‚                                    â”‚ Spawn   â”‚
       â”‚                                    â”‚ Thread  â”‚
       â”‚                                    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
       â”‚                                         â”‚
       â”‚  4. File Data (in chunks)               â”‚
       â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
       â”‚  5. More chunks...                      â”‚
       â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
       â”‚  6. Transfer complete                   â”‚
       â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
       â”‚                                         â”‚
       â”‚  7. Close connection                    â”‚
       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
       â”‚                                         â”‚
```

### Multithreading Architecture

**Server-Side: One Thread Per Client**

```
Main Thread (TCP Listener on port 8080)
    â”‚
    â”œâ”€â–º Thread 1 â†’ Client A (192.168.1.101)
    â”‚              â”œâ”€ Read file from disk
    â”‚              â””â”€ Send chunks over TCP
    â”‚
    â”œâ”€â–º Thread 2 â†’ Client B (192.168.1.102)
    â”‚              â”œâ”€ Read file from disk
    â”‚              â””â”€ Send chunks over TCP
    â”‚
    â””â”€â–º Thread N â†’ Client N
                   â””â”€ Independent file transfer
```

**Benefits:**

- ğŸ”„ Multiple clients can download simultaneously
- ğŸš« One slow client doesn't block others
- ğŸ§¹ Threads clean up automatically when done

**Client-Side: Dual-Thread Communication**

```
Client Process
    â”‚
    â”œâ”€â–º Read Thread  â† Receives file chunks from server
    â”‚                 â””â”€ Writes to local file
    â”‚
    â””â”€â–º Main Thread  â†’ User interface / Control flow
                      â””â”€ Manages connection lifecycle
```

## ğŸ¨ Current Features

- âœ… **P2P File Transfer** - Direct device-to-device sharing
- âœ… **TCP Protocol** - Reliable data transmission
- âœ… **Multithreaded Server** - Handle multiple clients at once
- âœ… **Chunk-based Transfer** - Memory-efficient for large files
- âœ… **Cross-platform** - Works on Linux, macOS, Windows
- âœ… **CLI Interface** - Simple command-line operation
- âœ… **Local & Network** - Share on localhost or across LAN

## ğŸš§ Planned Features

- ğŸ“Š **Progress Bars** - Visual transfer progress
- ğŸ” **Connection Codes** - Optional authentication
- ğŸ“ **Directory Transfer** - Share entire folders
- ğŸ”’ **Encryption** - Secure file transfers
- ğŸ“ **File Listing** - Browse available files before download
- ğŸ¯ **Resume Support** - Continue interrupted transfers
- ğŸŒ **NAT Traversal** - Share across different networks
- ğŸ“± **GUI Interface** - User-friendly desktop application

## ğŸ“ What You'll Learn

Building this project teaches you:

1. **Network Programming** ğŸŒ

   - TCP socket programming
   - Client-server architecture
   - IP addresses and ports

2. **Systems Programming** âš™ï¸

   - File I/O operations
   - Byte-level data handling
   - Buffer management

3. **Concurrent Programming** ğŸ§µ

   - Multithreading concepts
   - Thread safety and synchronization
   - Handling multiple connections

4. **Rust Language** ğŸ¦€
   - Ownership and borrowing
   - Error handling with `Result`
   - Module organization
   - CLI application development

## ğŸ¤ Use Cases

### Home Network Sharing

Transfer files between your laptop and desktop without USB drives or cloud storage.

### Quick Phone-to-PC Transfer

Turn your PC into a server and download files from your phone (with appropriate client).

### Collaborative Work

Share large files with colleagues on the same office network instantly.

### Offline Sharing

Transfer files without internet - perfect for areas with poor connectivity.

## ğŸ“š Prerequisites

- **Rust**: Install from [rustup.rs](https://rustup.rs/)
- **Cargo**: Comes with Rust installation
- **Basic networking knowledge**: Understanding of IP addresses and ports

## ğŸ”§ Installation

1. **Clone the repository:**

   ```bash
   git clone https://github.com/kishu279/cli-p2p-transfer.git
   cd file-transfer
   ```

2. **Build the project:**

   ```bash
   cargo build --release
   ```

3. **Run the application:**
   ```bash
   # Use 'cargo run' for development
   # Or use './target/release/file-transfer' for production
   ```

## ğŸ› Troubleshooting

### "Address already in use"

- Port is occupied by another application
- Solution: Choose a different port with `-p`

### "Connection refused"

- Server is not running or firewall is blocking
- Solution: Start server first, check firewall settings

### "Permission denied"

- No write permissions for save location
- Solution: Choose a directory you have write access to

### Can't connect across devices

- Firewall blocking the port
- Wrong IP address
- Solution: Use `ip addr` to verify server IP, open firewall port

## ğŸ“ License

This project is open source and available for educational purposes.

## ğŸ™ Acknowledgments

Built as a learning project to understand:

- Network programming fundamentals
- P2P architecture patterns
- Rust's memory safety and concurrency features

## ğŸ“ Contributing

Contributions, issues, and feature requests are welcome! Feel free to check the issues page.

---

**Built with â¤ï¸ using Rust ğŸ¦€**

_Make any device your personal file server!_
